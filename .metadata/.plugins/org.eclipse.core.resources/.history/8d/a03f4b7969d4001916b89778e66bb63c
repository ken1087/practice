<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>kang homework</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="container">
        <form action="/datainsert" method="POST" onsubmit="return join()">
        	<input type="text" name="num" autocomplete="off" id="num" placeholder="Number" required="required">
            <input type="text" name="userid" autocomplete="off" id="userid" placeholder="userId" required="required">
            <input type="text" name="stdnum" autocomplete="off" id="stdnum" placeholder="stdNum" required="required">
            <input type="text" name="mynum" autocomplete="off" id="mynum" placeholder="myNum" required="required">
            <input type="text" name="phone" autocomplete="off" id="phone" placeholder="phone" required="required">

            <input type="text" name="name" autocomplete="off" placeholder="name" required="required">
            <input type="text" name="password" autocomplete="off" placeholder="password" required="required">
            <input type="text" name="addr" autocomplete="off" placeholder="addr" required="required">
            <input type="text" name="title" autocomplete="off" placeholder="title" required="required">
            <input type="text" name="content" autocomplete="off" placeholder="content" required="required">
            <input type="text" name="country" autocomplete="off" placeholder="country" required="required">
            <input type="text" name="email" autocomplete="off" placeholder="email" required="required">
            <input type="text" name="gender" autocomplete="off" placeholder="gender" required="required">
            <div><input type="submit" value="insert"></div>
        </form>  
        <input type="button" value="check" id="checkid">
    </div>
    <script>
    	var check = 1;
		// 프라이머리 키 중복 체크
    	$("#checkid").click(function(){
        		var num_element 		= 		document.querySelector("#num");
        		var userid_element 		= 		document.querySelector("#userid");
        		var stdnum_element 	= 		document.querySelector("#stdnum");
        		var mynum_element 	= 		document.querySelector("#mynum");
        		var phone_element 		= 		document.querySelector("#phone");
        		
                var num 		= 		num_element.value;
                var userid 	= 		userid_element.value;
                var stdnum 	= 		stdnum_element.value;
                var mynum 	= 		mynum_element.value;
                var phone 	= 		phone_element.value;
		
                $.ajax({
                    
                    url:'/checkid',
                    headers: { 
                        "Content-Type": "application/json",                    
                    },
                    type: 'POST',
                    data: JSON.stringify({
                        'num' : num,
                        'userid' : userid,
                        'stdnum' : stdnum,
                        'mynum' : mynum,
                        'phone' : phone
                    }),
                    success: function (obj) {
                        if(1 == obj){
                            alert("사용가능"); 
                            check=0;                
                        }else{
                            alert("중복");
                          	check=1;
                        }
                    },
                    error: function () {               
                        alert("error");
                       
                    }
                })  
                
      
        })
    	
        function join(){
			if(check == 1){
				alert("중복 검사 하세요");
				return false;
			}
        }
    </script>
</body>
</html>